#!/bin/sh

while :
do
    case "$1" in
        -r | r | --remove) 
            pactl unload-module module-ladspa-sink
            echo "Unloaded normalized modules"
            exit ;;
        *)
            break ;;
    esac
done

if pactl list modules | grep -q 'Line Out Normalized'
then
    echo "Line output normalization already loaded"
else
    pactl load-module module-ladspa-sink sink_name='"Line Out"' master=alsa_output.pci-0000_00_1f.3.analog-stereo plugin=sc4_1882 label=sc4 control=1,1.5,401,-12,20,5,12
    pactl load-module module-ladspa-sink sink_name='"Line Out Normalized"' master='"Line Out"' plugin=fast_lookahead_limiter_1913 label=fastLookaheadLimiter control=10,-20,0.8
fi

if pactl list modules | grep -q 'Bluetooth Headset Normalized'
then
    echo "Bluetooth headphone normalization already loaded"
else
    # Might not be needed..
    pactl load-module module-ladspa-sink sink_name='"Bluetooth Headset"' master=bluez_output.88_C9_E8_8F_5D_6E.1 plugin=sc4_1882 label=sc4 control=1,1.5,401,-12,20,5,12
    pactl load-module module-ladspa-sink sink_name='"Bluetooth Headset Normalized"' master='"Bluetooth Headset"' plugin=fast_lookahead_limiter_1913 label=fastLookaheadLimiter control=10,-20,0.8
fi